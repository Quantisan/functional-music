(ns functional-music.tab-test
  (:require [clojure.test :refer :all]
            [functional-music.tab :refer :all]))

(def fast-car-tab ":Tornhearts76\r\nE-mail:Jackohearts_76@hotmail.co.uk\r\n\r\nTuning:Standard\r\n\r\nCapo on 2nd fret (Sounds fine without, i also like it on the 5th fret)\r\n\r\nVerse\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8--------7---7-----------------------------------|\r\nG|--0---------------0-----------0-----------0--------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3--------------------------------5---------------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8--------7---7-----------------------------------|\r\nG|--0---------------0-----------0-----------0--------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3--------------------------------5---------------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8------10--8----7-----8----7---------------------|\r\nG|--0---------------0-----------0--------------0-----------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3---------------------------------------5--------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8--------7---7-----------------------------------|\r\nG|--0---------------0-----------0-----------0--------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3--------------------------------5---------------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n   \r\n    Chorus\r\n\r\n      C     G    Em   D       C   Em  D         C  Em   D         C   D\r\n\r\ne|----0-----2----0----2----|--0---0---2~3~2--|--0---0---2~3~2--|--0---2------|\r\nB|----1-----2----0----3----|--1---0---3------|--1---0---3------|--1---3------|\r\nG|----0-----0----0----2----|--0---0---2------|--0---0---2------|--0---2------|\r\nD|----2-----0----2----0----|--2---2---0------|--2---2---0------|--2---0------|\r\nA|----3-----2----2---------|--3---2----------|--3---2----------|--3----------|\r\nE|----------3----0---------|------0----------|------0----------|-------------|\r\n\r\n    Verse\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8--------7---7-----------------------------------|\r\nG|--0---------------0-----------0-----------0--------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3--------------------------------5---------------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n\r\nOutro\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3---------------------------------------------------------------|\r\nG|--0------------------------------------------------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3------------------------------------------------------------------------|\r\nE|-----------3---------------------------------------------------------------|\r\n\r\n************************************\r\n\r\n| h   ")

(deftest tab->string-fret-test
  (is (= (tab->string-fret \- \- \- \- \- \-)
         []))
  (is (= (tab->string-fret \- \0 \0 \- \3 \-)
         [[1 3] [3 0] [4 0]])))

