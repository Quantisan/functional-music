(ns functional-music.tab-test
  (:require [clojure.test :refer :all]
            [functional-music.tab :refer :all]))

(def fast-car-tab ":Tornhearts76\r\nE-mail:Jackohearts_76@hotmail.co.uk\r\n\r\nTuning:Standard\r\n\r\nCapo on 2nd fret (Sounds fine without, i also like it on the 5th fret)\r\n\r\nVerse\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8--------7---7-----------------------------------|\r\nG|--0---------------0-----------0-----------0--------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3--------------------------------5---------------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8--------7---7-----------------------------------|\r\nG|--0---------------0-----------0-----------0--------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3--------------------------------5---------------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8------10--8----7-----8----7---------------------|\r\nG|--0---------------0-----------0--------------0-----------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3---------------------------------------5--------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8--------7---7-----------------------------------|\r\nG|--0---------------0-----------0-----------0--------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3--------------------------------5---------------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n   \r\n    Chorus\r\n\r\n      C     G    Em   D       C   Em  D         C  Em   D         C   D\r\n\r\ne|----0-----2----0----2----|--0---0---2~3~2--|--0---0---2~3~2--|--0---2------|\r\nB|----1-----2----0----3----|--1---0---3------|--1---0---3------|--1---3------|\r\nG|----0-----0----0----2----|--0---0---2------|--0---0---2------|--0---2------|\r\nD|----2-----0----2----0----|--2---2---0------|--2---2---0------|--2---0------|\r\nA|----3-----2----2---------|--3---2----------|--3---2----------|--3----------|\r\nE|----------3----0---------|------0----------|------0----------|-------------|\r\n\r\n    Verse\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3--3-----------8--------7---7-----------------------------------|\r\nG|--0---------------0-----------0-----------0--------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3--------------------------------5---------------------------------------|\r\nE|-----------3--------------0------------------------------------------------|\r\n\r\nOutro\r\n\r\ne|---------------------------------------------------------------------------|\r\nB|--0h1--0---3---------------------------------------------------------------|\r\nG|--0------------------------------------------------------------------------|\r\nD|---------------------------------------------------------------------------|\r\nA|--3------------------------------------------------------------------------|\r\nE|-----------3---------------------------------------------------------------|\r\n\r\n************************************\r\n\r\n| h   ")
(def fast-car-vec '(() () (1 3 3 0 4 0) () (4 1) () () (4 0) () () () (0 3 4 3) () () (4 3) () () () (3 0) () () () () () () () (0 0 4 8) () () () (3 0) () () () () (1 5 4 7) () () () (4 7) () () (3 0) () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () (1 3 3 0 4 0) () (4 1) () () (4 0) () () () (0 3 4 3) () () (4 3) () () () (3 0) () () () () () () () (0 0 4 8) () () () (3 0) () () () () (1 5 4 7) () () () (4 7) () () (3 0) () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () (1 3 3 0 4 0) () (4 1) () () (4 0) () () () (0 3 4 3) () () (4 3) () () () (3 0) () () () () () () () (0 0 4 8) () () () (3 0) () () (4 10) () () () (4 8) () () () () (1 5 4 7) () () (3 0) () () (4 8) () () () () (4 7) () () () () () () () () () () () () () () () () () () () () () () () (1 3 3 0 4 0) () (4 1) () () (4 0) () () () (0 3 4 3) () () (4 3) () () () (3 0) () () () () () () () (0 0 4 8) () () () (3 0) () () () () (1 5 4 7) () () () (4 7) () () (3 0) () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () (1 3 2 2 3 0 4 1 5 0) () () () () () (0 3 1 2 2 0 3 0 4 2 5 2) () () () () (0 0 1 2 2 2 3 0 4 0 5 0) () () () () (2 0 3 2 4 3 5 2) () () () () () () () (1 3 2 2 3 0 4 1 5 0) () () () (0 0 1 2 2 2 3 0 4 0 5 0) () () () (2 0 3 2 4 3 5 2) () (5 3) () (5 2) () () () () () (1 3 2 2 3 0 4 1 5 0) () () () (0 0 1 2 2 2 3 0 4 0 5 0) () () () (2 0 3 2 4 3 5 2) () (5 3) () (5 2) () () () () () (1 3 2 2 3 0 4 1 5 0) () () () (2 0 3 2 4 3 5 2) () () () () () () () () (1 3 3 0 4 0) () (4 1) () () (4 0) () () () (0 3 4 3) () () (4 3) () () () (3 0) () () () () () () () (0 0 4 8) () () () (3 0) () () () () (1 5 4 7) () () () (4 7) () () (3 0) () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () (1 3 3 0 4 0) () (4 1) () () (4 0) () () () (0 3 4 3) () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () () ()))

(deftest parse-guitar-tab-test
  (is (= fast-car-vec (parse-guitar-tab fast-car-tab))))

